(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function c(e){const t=document.getElementById(e);if(!t)throw new Error(`Element '${e}' not found`);return t}class f{window=c("console-window");content=c("console-content");command_path=c("console-command-path");input_command=c("console-command");clear_button=c("console-clear-button");hide_button=c("console-hide-button");show_button=c("console-show-button");constructor(){this.window.addEventListener("click",()=>{this.__focusCommandInput()}),this.clear_button.addEventListener("click",()=>{this.__clearConsole()}),this.show_button.addEventListener("click",()=>{this.__showConsole(),this.__focusCommandInput()}),this.hide_button.addEventListener("click",()=>{this.__hideConsole()})}appendToConsole(t){this.content.innerText+=t}setCommandPathValue(t){this.command_path.innerText=t}getInputCommandValue(){return this.input_command.value}clearInputCommandValue(){this.input_command.value=""}setInputKeyDownEventListener(t){this.input_command.addEventListener("keydown",t)}__clearConsole(){this.content.innerText=""}__showConsole(){this.window.style.display="block",this.show_button.style.display="none"}__hideConsole(){this.window.style.display="none",this.show_button.style.display="block"}__focusCommandInput(){this.input_command.focus()}}const u=new f;function l(e){_("[SYSTEM][I]: ",e)}function a(e){_("[SYSTEM][E]: ",e)}function w(e){_("[ARDUINO]: ",e)}function _(e,t){u.appendToConsole(e+t+`
`),console.log(e+t)}const h={status:c("arduino-status"),keep_connection_checkbox:c("arduino-keep-connection-checkbox")};class k{__socket;__keep_connection;SERVER_ADDRESS="192.168.1.250:55555";constructor(){this.__socket=null,this.__keep_connection=!1}getConnectionMode(){return this.__keep_connection}setConnectionMode(t){this.__keep_connection=t}connect(){return this.isOpen()&&this.__socket.close(),this.__socket=new WebSocket(`ws://${this.SERVER_ADDRESS}`),this.__socket.onclose=()=>{h.status.innerText="Disconnected",l("Disconnected from the server")},l("Waiting for server to come online..."),new Promise((t,r)=>{if(!this.__socket)return r();this.__socket.onopen=()=>(h.status.innerText="Connected",l("Connected to the server"),t()),this.__socket.onerror=o=>(a(`WebSocket error: ${o}`),r())})}sendCommandAndGetOutput(t){return new Promise((r,o)=>{if(!this.isOpen()||!this.__socket)return a("Couldn't send request: socket not initialized"),o();let n;n=`Connection: ${this.__keep_connection?"keep_connection":"close_connection"}`+`
-- HEADER END --
`+t,this.__socket.send(n),l(`Sent request:
${n}`),this.__socket.onmessage=i=>r(i.data),this.__socket.onerror=()=>(a("WebSocket error"),o())})}async getHostsJson(){try{return await this.connect(),await this.sendCommandAndGetOutput("GetHostsJson")}catch(t){throw console.error("Error obtaining hosts JSON: ",t),t}}isOpen(){return this.__socket?.readyState===WebSocket.OPEN}}const d=new k;class C{hosts_container=c("hosts-container");renderHosts(t,r){try{const o=JSON.parse(t),n=o.number_of_hosts;for(let s=0;s<n;s++){const i=this.__getHostHtml(o[`${s}`]);this.__appendHost(i)}this.hosts_container.addEventListener("click",s=>{const i=s.target;if(i.classList.contains("boot-shutdown-button")){const p=i.getAttribute("data-hostname");r(`Boot ${p}`)}})}catch(o){const n=o instanceof Error?o.message:String(o);a(n)}}removeAllHosts(){this.hosts_container.innerHTML=""}__getHostHtml(t){let r=t.name,o=t.type;return`
        <div class="host">
            <img src="/${o}.png" alt="${o}">

            <div class="details-container">
                <div id="host-name">${r}</div>
                <div id="host-type">${o}</div>
            </div>

            <div class="button-container">
                <button class="boot-shutdown-button" data-hostname="${r}">Boot/Shutdown</button>
            </div>
        </div>
        `}__appendHost(t){this.hosts_container.innerHTML+=t}}const y=new C;u.setCommandPathValue(`Arduino@${d.SERVER_ADDRESS}>`);u.setInputKeyDownEventListener(e=>{if(e.key==="Enter"){const t=u.getInputCommandValue().trim();m(t),u.clearInputCommandValue()}});async function m(e){if(d.setConnectionMode(h.keep_connection_checkbox.checked),!e){a("No command provided, skipping");return}let t;d.isOpen()?t=await g(e):t=await b(e),w(t)}async function b(e){try{return await d.connect(),await d.sendCommandAndGetOutput(e)}catch(t){a(`Error during command execution: ${t}`)}}async function g(e){try{return await d.sendCommandAndGetOutput(e)}catch(t){a(`Error during command execution: ${t}`)}}y.renderHosts(await d.getHostsJson(),m);
